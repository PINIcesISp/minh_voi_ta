// ==UserScript==
// @name         n-e-w-t-o-k-i
// @namespace    https://github.com/PINIcesISp/minh_voi_ta/raw/main/n-e-w-t-o-k-i.user.js
// @version      2024.08.20
// @description  down n-e-w-t-o-k-i
// @author       You
// @include      /^https?://newtoki\d+\.com/webtoon/*/*/
// @icon         https://www.google.com/s2/favicons?sz=64&domain=newtoki349.com
// @require      https://cdn.jsdelivr.net/npm/@zip.js/zip.js@2.7.48/dist/zip.min.js
// @downloadURL  https://github.com/PINIcesISp/minh_voi_ta/raw/main/n-e-w-t-o-k-i.user.js
// @updateURL    https://github.com/PINIcesISp/minh_voi_ta/raw/main/n-e-w-t-o-k-i.meta.js
// ==/UserScript==

function a0_0x45a4(_0xc697ab,_0x4c0cf1){const _0x58f165=a0_0x58f1();return a0_0x45a4=function(_0x45a4c6,_0x5acc49){_0x45a4c6=_0x45a4c6-0xbe;let _0x4b5fd5=_0x58f165[_0x45a4c6];return _0x4b5fd5;},a0_0x45a4(_0xc697ab,_0x4c0cf1);}function a0_0x58f1(){const _0x15962d=['createElement','name','body','268935vXJYVj','\x0a\x20\x20\x20\x20\x20\x20\x20\x20.status-num\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Acme\x27,\x20sans-serif\x20!important;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x205rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#FD7377;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-webkit-text-stroke:\x201px\x20#C62428;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x200.2rem\x20solid\x20#167975;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x201rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x200\x202rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#F9FDFD;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200.5rem\x200.6rem\x20#2E8B87;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20min-height:\x204rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','href','top','heartbeat','center','appendChild','tai-ve','setAttribute','src','ZipWriter','map','width','6629480GfUTDi','createObjectURL','padStart','24BKmYLc','.png','URL','splice','match','display','cursor','5rem','0.5rem','\x0a\x20\x20\x20\x20\x20\x20.tai-ve\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20animation:\x20heartbeat\x202s\x20infinite;\x20/*\x20Apply\x20the\x20heartbeat\x20animation\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform-origin:\x20center;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20@keyframes\x20heartbeat\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x200%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20Start\x20with\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2025%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200.7;\x20/*\x20Fade\x20out\x20slightly\x20at\x2025%\x20of\x20the\x20animation\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2050%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1.2);\x20/*\x20Scale\x20up\x20at\x2050%\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20Return\x20to\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2075%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200.7;\x20/*\x20Fade\x20out\x20slightly\x20at\x2075%\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20100%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20End\x20with\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20','image/png','className','BlobWriter','click','left','1000000','head','alignItems','422612MwecYj','slice','add','.zip','filter','absolute','textContent','gap','img','translate(-50%)','52494646','6621507OtxlMm','4DkIuFY','#heartbeat','image/jpeg','querySelector','9RbEwcQ','length','\x20/\x20','pointer','getElementsByTagName','none','replace','remove','1.5rem','status-num','link','.jpg','flex','arrayBuffer','div','https://fonts.googleapis.com/css2?family=Acme&display=swap','6674448varsiI','.webp','3697323mLdopN','style','https://github.com/NAgEustiCa/1_con_kien_2_con_kien/raw/main/tai_icon.png','parseInt','zIndex','89504e47','close','forEach','insertBefore','transform','.status-num','37832zLarmI','push','status','getUint32','rel'];a0_0x58f1=function(){return _0x15962d;};return a0_0x58f1();}(function(_0x4ef236,_0x5f1d0b){const _0x1f9643=a0_0x45a4,_0x585bd7=_0x4ef236();while(!![]){try{const _0x59b9ba=parseInt(_0x1f9643(0xf1))/0x1*(-parseInt(_0x1f9643(0xd0))/0x2)+parseInt(_0x1f9643(0xd4))/0x3*(parseInt(_0x1f9643(0xc4))/0x4)+-parseInt(_0x1f9643(0xf9))/0x5*(-parseInt(_0x1f9643(0x109))/0x6)+parseInt(_0x1f9643(0xe6))/0x7+parseInt(_0x1f9643(0xe4))/0x8+-parseInt(_0x1f9643(0xcf))/0x9+-parseInt(_0x1f9643(0x106))/0xa;if(_0x59b9ba===_0x5f1d0b)break;else _0x585bd7['push'](_0x585bd7['shift']());}catch(_0x2cbe94){_0x585bd7['push'](_0x585bd7['shift']());}}}(a0_0x58f1,0x669ab));let downloading_current=0x0,downloading_total=0x0,image_blobs;function sleep(_0x436354){return new Promise(_0x22d2b0=>setTimeout(_0x22d2b0,_0x436354));}const download_not_encrypted=async(_0x160158,_0x43db50)=>{const _0x480197=a0_0x45a4,_0x15811a=await fetch(_0x160158),_0x1ae975=await _0x15811a[_0x480197(0xe1)]();let _0x2b456e=(''+(_0x43db50+0x1))[_0x480197(0x108)](0x3,'0');const _0x5cced6=new DataView(_0x1ae975),_0x126ea6=_0x5cced6[_0x480197(0xf4)](0x0,![])['toString'](0x10);if(_0x126ea6===_0x480197(0xce)){const _0x1d65e9=new Blob([_0x1ae975],{'type':'image/webp'});image_blobs[_0x480197(0xf2)]({'name':_0x2b456e+_0x480197(0xe5),'blob':_0x1d65e9}),downloading_current+=0x1,downloading_current===downloading_total&&off_heartbeat_css(),update_status();}else{if(_0x126ea6===_0x480197(0xeb)){const _0xc510b8=new Blob([_0x1ae975],{'type':_0x480197(0x113)});image_blobs[_0x480197(0xf2)]({'name':_0x2b456e+_0x480197(0x10a),'blob':_0xc510b8}),downloading_current+=0x1,downloading_current===downloading_total&&off_heartbeat_css(),update_status();}else{const _0x205cfe=new Blob([_0x1ae975],{'type':_0x480197(0xd2)});image_blobs[_0x480197(0xf2)]({'name':_0x2b456e+_0x480197(0xdf),'blob':_0x205cfe}),downloading_current+=0x1,downloading_current===downloading_total&&off_heartbeat_css(),update_status();}}};function update_status(){const _0x28e17e=a0_0x45a4;document[_0x28e17e(0xd3)](_0x28e17e(0xf0))[_0x28e17e(0xe7)][_0x28e17e(0x10e)]=_0x28e17e(0xe0),document[_0x28e17e(0xd3)](_0x28e17e(0xf0))['style'][_0x28e17e(0xc3)]=_0x28e17e(0xfe),document[_0x28e17e(0xd3)]('.status-num')['innerHTML']=downloading_current+_0x28e17e(0xd6)+downloading_total;}function create_status_box(){const _0x4c77b7=a0_0x45a4;let _0x26f9fa=document['createElement'](_0x4c77b7(0xe2));return _0x26f9fa[_0x4c77b7(0x114)]=_0x4c77b7(0xdd),_0x26f9fa[_0x4c77b7(0xca)]=downloading_current+_0x4c77b7(0xd6)+downloading_total,_0x26f9fa;}function create_download_icon(){const _0x4e543b=a0_0x45a4;let _0x6d6f17=document[_0x4e543b(0xf6)](_0x4e543b(0xe2)),_0xdef229=document[_0x4e543b(0xf6)](_0x4e543b(0xcc));_0xdef229[_0x4e543b(0x114)]=_0x4e543b(0x100),_0xdef229['setAttribute'](_0x4e543b(0x102),_0x4e543b(0xe8)),_0xdef229[_0x4e543b(0xe7)][_0x4e543b(0x105)]=_0x4e543b(0x110),_0xdef229['style'][_0x4e543b(0x10f)]=_0x4e543b(0xd7),_0x6d6f17[_0x4e543b(0xff)](_0xdef229);let _0xd95a94=document[_0x4e543b(0xf6)](_0x4e543b(0xde));_0xd95a94[_0x4e543b(0xf5)]='stylesheet',_0xd95a94[_0x4e543b(0xfb)]=_0x4e543b(0xe3),document[_0x4e543b(0xd8)](_0x4e543b(0xc2))[0x0]['appendChild'](_0xd95a94);let _0x191c82=document[_0x4e543b(0xf6)](_0x4e543b(0xe2));_0x191c82['className']=_0x4e543b(0xf3),_0x191c82[_0x4e543b(0xe7)][_0x4e543b(0x10e)]=_0x4e543b(0xe0),_0x191c82[_0x4e543b(0xe7)]['justifyContent']=_0x4e543b(0xfe),_0x191c82[_0x4e543b(0xe7)][_0x4e543b(0xc3)]=_0x4e543b(0xfe),_0x191c82['style'][_0x4e543b(0xcb)]=_0x4e543b(0xdc),_0x191c82[_0x4e543b(0xe7)]['position']=_0x4e543b(0xc9),_0x191c82[_0x4e543b(0xe7)][_0x4e543b(0xea)]=_0x4e543b(0xc1),_0x191c82['style'][_0x4e543b(0xfc)]=_0x4e543b(0x111),_0x191c82['style'][_0x4e543b(0xc0)]='50vw',_0x191c82['style'][_0x4e543b(0xef)]=_0x4e543b(0xcd);let _0x29fc8c=create_status_box();const _0x2a3cca=document[_0x4e543b(0xf6)](_0x4e543b(0xe7));_0x2a3cca[_0x4e543b(0xca)]=_0x4e543b(0xfa),document['head']['appendChild'](_0x2a3cca),_0x191c82[_0x4e543b(0xff)](_0x6d6f17),_0x191c82[_0x4e543b(0xff)](_0x29fc8c);let _0x4be18a=document[_0x4e543b(0xd3)]('body'),_0x3afaa1=_0x4be18a['firstChild'];return _0x4be18a[_0x4e543b(0xee)](_0x191c82,_0x3afaa1),_0x191c82;}const throttlePromises=async(_0x276b93,_0x46cbd9)=>{const _0x174197=a0_0x45a4;while(_0x276b93[_0x174197(0xd5)]>0x0){await Promise['all'](_0x276b93[_0x174197(0x10c)](0x0,_0x46cbd9)[_0x174197(0x104)](_0x5c54f6=>_0x5c54f6())),await sleep(0xc8);}},on_heartbeat_css=()=>{const _0x1929ef=a0_0x45a4;let _0xfc0ee9=document[_0x1929ef(0xd3)](_0x1929ef(0xd1));!_0xfc0ee9&&(_0xfc0ee9=document[_0x1929ef(0xf6)](_0x1929ef(0xe7)),_0xfc0ee9[_0x1929ef(0x101)]('id',_0x1929ef(0xfd)),document['head']['appendChild'](_0xfc0ee9)),_0xfc0ee9[_0x1929ef(0xca)]=_0x1929ef(0x112);},off_heartbeat_css=()=>{const _0x1fc6bd=document['querySelector']('#heartbeat');_0x1fc6bd['textContent']='';},htmlEncoder=_0x37e74e=>{const _0x27ee8b=a0_0x45a4;let _0x57d57b='';for(let _0x29f580=0x0;_0x29f580<_0x37e74e[_0x27ee8b(0xd5)];_0x29f580+=0x3){_0x57d57b+=String['fromCodePoint'](Number[_0x27ee8b(0xe9)](_0x37e74e[_0x27ee8b(0xc5)](_0x29f580,_0x29f580+0x2),0x10));}return _0x57d57b;};function saveBlob(_0xbd3f2a,_0x4f656d){const _0x305737=a0_0x45a4,_0x2fca2d=window[_0x305737(0x10b)][_0x305737(0x107)](_0xbd3f2a),_0xfe8e2b=document[_0x305737(0xf6)]('a');_0xfe8e2b[_0x305737(0xfb)]=_0x2fca2d,_0xfe8e2b['download']=_0x4f656d,_0xfe8e2b['style']['display']=_0x305737(0xd9),document[_0x305737(0xf8)][_0x305737(0xff)](_0xfe8e2b),_0xfe8e2b['click'](),_0xfe8e2b[_0x305737(0xdb)](),window[_0x305737(0x10b)]['revokeObjectURL'](_0x2fca2d),image_blobs=null;}((async()=>{const _0x39f989=a0_0x45a4,_0x9751f9=htmlEncoder(html_data),_0x2ba074=_0x9751f9[_0x39f989(0x10d)](/src="\/img\/loading-image.gif" data-.+?="(.+?)"/g)[_0x39f989(0x104)](_0x1ffbca=>_0x1ffbca[_0x39f989(0x10d)](/data-.+?="(.+?)"/)[0x1])[_0x39f989(0xc8)](_0x13f375=>_0x13f375['includes']('newtoki'));let _0x5a4baa=document[_0x39f989(0xd3)]('.toon-title')['firstChild'][_0x39f989(0xca)]['trim']()[_0x39f989(0xda)]('.','');if(_0x2ba074[_0x39f989(0xd5)]>0x0){downloading_total=_0x2ba074['length'];const _0x326d8e=create_download_icon();_0x326d8e['addEventListener'](_0x39f989(0xbf),async()=>{const _0x282b84=_0x39f989;on_heartbeat_css(),downloading_current=0x0,image_blobs=[];let _0x544a9c;_0x544a9c=_0x2ba074[_0x282b84(0x104)]((_0x1d5de9,_0x4d68ff)=>()=>download_not_encrypted(_0x1d5de9,_0x4d68ff)),await throttlePromises(_0x544a9c,0x4);const _0x5caff5=new zip[(_0x282b84(0xbe))]('application/zip'),_0x351c2f=new zip[(_0x282b84(0x103))](_0x5caff5);image_blobs[_0x282b84(0xed)](async _0x3149c1=>{const _0x41fac2=_0x282b84;await _0x351c2f[_0x41fac2(0xc6)](_0x3149c1[_0x41fac2(0xf7)],new zip['BlobReader'](_0x3149c1['blob']));});const _0x1552df=await _0x351c2f[_0x282b84(0xec)]();saveBlob(_0x1552df,_0x5a4baa+_0x282b84(0xc7));});}})());